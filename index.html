<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weer in Zeist - Geanimeerde Lucht</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        .sky {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #0c1445 0%, #1a237e 100%);
            transition: background 10s ease;
        }

        .sun {
            position: absolute;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, #fff700 0%, #ffea00 30%, #ffc107 70%, transparent 100%);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 2s ease;
            filter: blur(1px);
            box-shadow: 0 0 60px #fff700;
        }

        .moon {
            position: absolute;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle at 30% 30%, #f5f5f5, #e0e0e0);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 2s ease;
            box-shadow: 0 0 40px rgba(245, 245, 245, 0.3);
        }

        .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 70%;
            opacity: 0;
            transition: opacity 3s ease;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite alternate;
        }

        .star.small { width: 1px; height: 1px; }
        .star.medium { width: 2px; height: 2px; }
        .star.large { width: 3px; height: 3px; }

        @keyframes twinkle {
            0% { opacity: 0.3; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.2); }
        }

        .clouds {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50px;
            opacity: 0.7;
            animation: drift 60s linear infinite;
        }

        .cloud:before {
            content: '';
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50px;
        }

        .cloud:after {
            content: '';
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50px;
        }

        @keyframes drift {
            0% { transform: translateX(-200px); }
            100% { transform: translateX(calc(100vw + 200px)); }
        }

        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0;
            transition: opacity 2s ease;
        }

        .rain-drop {
            position: absolute;
            width: 2px;
            height: 15px;
            background: rgba(135, 206, 235, 0.6);
            border-radius: 1px;
            animation: rainfall 1s linear infinite;
        }

        .snow-flake {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            animation: snowfall 3s linear infinite;
        }

        @keyframes rainfall {
            0% { transform: translateY(-100px) rotate(10deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(100vh) rotate(10deg); opacity: 0; }
        }

        @keyframes snowfall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        .weather-info {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            padding: 20px;
            color: white;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }

        .location {
            font-size: 18px;
            font-weight: 300;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .temperature {
            font-size: 48px;
            font-weight: 200;
            margin-bottom: 5px;
        }

        .feels-like {
            font-size: 16px;
            opacity: 0.8;
            margin-bottom: 15px;
        }

        .description {
            font-size: 20px;
            font-weight: 400;
            margin-bottom: 15px;
            text-transform: capitalize;
        }

        .details {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            opacity: 0.9;
        }

        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }

        @media (max-width: 768px) {
            .weather-info {
                padding: 15px;
            }
            .temperature {
                font-size: 36px;
            }
            .description {
                font-size: 18px;
            }
            .details {
                gap: 15px;
            }
            .sun {
                width: 80px;
                height: 80px;
            }
            .moon {
                width: 60px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="sky" id="sky">
        <div class="sun" id="sun"></div>
        <div class="moon" id="moon"></div>
        <div class="stars" id="stars"></div>
        <div class="clouds" id="clouds"></div>
        <div class="particles" id="rainParticles"></div>
        <div class="particles" id="snowParticles"></div>
    </div>

    <div class="loading" id="loading">Weerdata laden...</div>

    <div class="weather-info" id="weatherInfo" style="display: none;">
        <div class="location">Zeist, Nederland</div>
        <div class="temperature" id="temperature">-¬∞</div>
        <div class="feels-like" id="feelsLike">Voelt aan als -¬∞</div>
        <div class="description" id="description">-</div>
        <div class="details">
            <div class="detail-item">
                <span>üí®</span>
                <span id="wind">- km/h</span>
            </div>
            <div class="detail-item">
                <span>üíß</span>
                <span id="humidity">-%</span>
            </div>
            <div class="detail-item">
                <span>‚òÅÔ∏è</span>
                <span id="cloudCover">-%</span>
            </div>
        </div>
    </div>

    <script>
        // Weather code translations to Dutch
        const weatherDescriptions = {
            0: 'Helder',
            1: 'Overwegend helder',
            2: 'Gedeeltelijk bewolkt',
            3: 'Bewolkt',
            45: 'Mist',
            48: 'Ijsmist',
            51: 'Lichte motregen',
            53: 'Matige motregen',
            55: 'Dichte motregen',
            56: 'Lichte ijzel',
            57: 'Dichte ijzel',
            61: 'Lichte regen',
            63: 'Matige regen',
            65: 'Zware regen',
            66: 'Lichte ijsregen',
            67: 'Zware ijsregen',
            71: 'Lichte sneeuw',
            73: 'Matige sneeuw',
            75: 'Zware sneeuw',
            77: 'Sneeuwkorrels',
            80: 'Lichte buien',
            81: 'Matige buien',
            82: 'Zware buien',
            85: 'Lichte sneeuwbuien',
            86: 'Zware sneeuwbuien',
            95: 'Onweer',
            96: 'Onweer met hagel',
            99: 'Zwaar onweer met hagel'
        };

        // Wind direction mapping
        const windDirections = {
            0: 'N', 45: 'NO', 90: 'O', 135: 'ZO',
            180: 'Z', 225: 'ZW', 270: 'W', 315: 'NW', 360: 'N'
        };

        // Global variables
        let weatherData = null;
        let animationFrame = null;
        let clouds = [];
        let rainDrops = [];
        let snowFlakes = [];

        // Initialize the app
        async function init() {
            await fetchWeatherData();
            createStars();
            createClouds();
            startAnimationLoop();
            
            // Auto-refresh every 10 minutes
            setInterval(fetchWeatherData, 10 * 60 * 1000);
        }

        // Fetch weather data from Open-Meteo API
        async function fetchWeatherData() {
            try {
                const response = await fetch(
                    'https://api.open-meteo.com/v1/forecast?latitude=52.09&longitude=5.23&current=temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,cloud_cover,wind_speed_10m,wind_direction_10m&hourly=temperature_2m,weather_code,cloud_cover&daily=sunrise,sunset&timezone=Europe/Amsterdam&forecast_days=1'
                );
                
                weatherData = await response.json();
                updateWeatherDisplay();
                updateSkyAnimation();
                document.getElementById('loading').style.display = 'none';
                document.getElementById('weatherInfo').style.display = 'block';
            } catch (error) {
                console.error('Error fetching weather data:', error);
                document.getElementById('loading').textContent = 'Fout bij laden weerdata';
            }
        }

        // Update weather display
        function updateWeatherDisplay() {
            if (!weatherData) return;

            const current = weatherData.current;
            const daily = weatherData.daily;

            document.getElementById('temperature').textContent = `${Math.round(current.temperature_2m)}¬∞`;
            document.getElementById('feelsLike').textContent = `Voelt aan als ${Math.round(current.apparent_temperature)}¬∞`;
            document.getElementById('description').textContent = weatherDescriptions[current.weather_code] || 'Onbekend';
            
            const windDir = getWindDirection(current.wind_direction_10m);
            document.getElementById('wind').textContent = `${Math.round(current.wind_speed_10m)} km/h ${windDir}`;
            document.getElementById('humidity').textContent = `${current.relative_humidity_2m}%`;
            document.getElementById('cloudCover').textContent = `${current.cloud_cover}%`;

            // Update particles based on weather
            updateWeatherParticles(current.weather_code);
        }

        // Get wind direction from degrees
        function getWindDirection(degrees) {
            const directions = ['N', 'NNO', 'NO', 'ONO', 'O', 'OZO', 'ZO', 'ZZO', 'Z', 'ZZW', 'ZW', 'WZW', 'W', 'WNW', 'NW', 'NNW'];
            const index = Math.round(degrees / 22.5) % 16;
            return directions[index];
        }

        // Update sky animation based on time and weather
        function updateSkyAnimation() {
            if (!weatherData) return;

            const now = new Date();
            const sunrise = new Date(weatherData.daily.sunrise[0]);
            const sunset = new Date(weatherData.daily.sunset[0]);
            
            const skyGradient = getSkyGradient(now, sunrise, sunset);
            document.getElementById('sky').style.background = skyGradient;

            updateSunMoonPosition(now, sunrise, sunset);
            updateStarsVisibility(now, sunrise, sunset);
            updateCloudsOpacity(weatherData.current.cloud_cover);
        }

        // Calculate sky gradient based on time of day
        function getSkyGradient(now, sunrise, sunset) {
            const hour = now.getHours() + now.getMinutes() / 60;
            const sunriseHour = sunrise.getHours() + sunrise.getMinutes() / 60;
            const sunsetHour = sunset.getHours() + sunset.getMinutes() / 60;

            if (hour < sunriseHour - 1) {
                // Night
                return 'linear-gradient(to bottom, #0c1445 0%, #1a237e 50%, #2c387e 100%)';
            } else if (hour < sunriseHour + 1) {
                // Dawn
                return 'linear-gradient(to bottom, #ff6b35 0%, #f9ca24 30%, #6c5ce7 60%, #74b9ff 100%)';
            } else if (hour < sunsetHour - 1) {
                // Day
                return 'linear-gradient(to bottom, #74b9ff 0%, #0984e3 50%, #74b9ff 100%)';
            } else if (hour < sunsetHour + 1) {
                // Sunset
                return 'linear-gradient(to bottom, #fd79a8 0%, #fdcb6e 30%, #e17055 60%, #2d3436 100%)';
            } else {
                // Night
                return 'linear-gradient(to bottom, #0c1445 0%, #1a237e 50%, #2c387e 100%)';
            }
        }

        // Update sun and moon position
        function updateSunMoonPosition(now, sunrise, sunset) {
            const hour = now.getHours() + now.getMinutes() / 60;
            const sunriseHour = sunrise.getHours() + sunrise.getMinutes() / 60;
            const sunsetHour = sunset.getHours() + sunset.getMinutes() / 60;

            const sun = document.getElementById('sun');
            const moon = document.getElementById('moon');

            if (hour >= sunriseHour && hour <= sunsetHour) {
                // Daytime - show sun
                const progress = (hour - sunriseHour) / (sunsetHour - sunriseHour);
                const x = progress * (window.innerWidth - 120);
                const y = Math.sin(progress * Math.PI) * -200 + window.innerHeight * 0.3;
                
                sun.style.left = `${x}px`;
                sun.style.top = `${y}px`;
                sun.style.opacity = '1';
                moon.style.opacity = '0';
            } else {
                // Nighttime - show moon
                let moonProgress;
                if (hour > sunsetHour) {
                    moonProgress = (hour - sunsetHour) / (24 - sunsetHour + sunriseHour);
                } else {
                    moonProgress = (hour + 24 - sunsetHour) / (24 - sunsetHour + sunriseHour);
                }
                
                const x = moonProgress * (window.innerWidth - 80);
                const y = Math.sin(moonProgress * Math.PI) * -150 + window.innerHeight * 0.2;
                
                moon.style.left = `${x}px`;
                moon.style.top = `${y}px`;
                moon.style.opacity = '0.9';
                sun.style.opacity = '0';
            }
        }

        // Update stars visibility
        function updateStarsVisibility(now, sunrise, sunset) {
            const hour = now.getHours() + now.getMinutes() / 60;
            const sunriseHour = sunrise.getHours() + sunrise.getMinutes() / 60;
            const sunsetHour = sunset.getHours() + sunset.getMinutes() / 60;

            const stars = document.getElementById('stars');
            if (hour < sunriseHour - 0.5 || hour > sunsetHour + 0.5) {
                stars.style.opacity = '1';
            } else {
                stars.style.opacity = '0';
            }
        }

        // Create stars
        function createStars() {
            const starsContainer = document.getElementById('stars');
            const starCount = 150;

            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = `star ${['small', 'medium', 'large'][Math.floor(Math.random() * 3)]}`;
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 70}%`;
                star.style.animationDelay = `${Math.random() * 3}s`;
                star.style.animationDuration = `${2 + Math.random() * 2}s`;
                starsContainer.appendChild(star);
            }
        }

        // Create clouds
        function createClouds() {
            const cloudsContainer = document.getElementById('clouds');
            const cloudCount = 6;

            for (let i = 0; i < cloudCount; i++) {
                const cloud = document.createElement('div');
                cloud.className = 'cloud';
                
                const size = 60 + Math.random() * 80;
                const height = size * 0.6;
                
                cloud.style.width = `${size}px`;
                cloud.style.height = `${height}px`;
                cloud.style.top = `${Math.random() * 40}%`;
                cloud.style.animationDelay = `${Math.random() * 60}s`;
                cloud.style.animationDuration = `${40 + Math.random() * 40}s`;

                // Create cloud parts for more realistic shape
                cloud.style.setProperty('--before-width', `${size * 0.5}px`);
                cloud.style.setProperty('--before-height', `${height * 0.8}px`);
                cloud.style.setProperty('--before-left', `${size * 0.1}px`);
                cloud.style.setProperty('--before-top', `${height * 0.1}px`);

                cloud.style.setProperty('--after-width', `${size * 0.3}px`);
                cloud.style.setProperty('--after-height', `${height * 0.7}px`);
                cloud.style.setProperty('--after-left', `${size * 0.6}px`);
                cloud.style.setProperty('--after-top', `${height * 0.15}px`);

                cloudsContainer.appendChild(cloud);
                clouds.push(cloud);
            }

            // Add CSS custom properties for cloud shapes
            const style = document.createElement('style');
            style.textContent = `
                .cloud:before {
                    width: var(--before-width);
                    height: var(--before-height);
                    left: var(--before-left);
                    top: var(--before-top);
                }
                .cloud:after {
                    width: var(--after-width);
                    height: var(--after-height);
                    left: var(--after-left);
                    top: var(--after-top);
                }
            `;
            document.head.appendChild(style);
        }

        // Update clouds opacity based on cloud cover
        function updateCloudsOpacity(cloudCover) {
            clouds.forEach(cloud => {
                cloud.style.opacity = (cloudCover / 100) * 0.8 + 0.2;
            });
        }

        // Update weather particles (rain/snow)
        function updateWeatherParticles(weatherCode) {
            const rainContainer = document.getElementById('rainParticles');
            const snowContainer = document.getElementById('snowParticles');

            // Clear existing particles
            rainContainer.innerHTML = '';
            snowContainer.innerHTML = '';
            rainDrops = [];
            snowFlakes = [];

            if (weatherCode >= 51 && weatherCode <= 67 || weatherCode >= 80 && weatherCode <= 82) {
                // Rain
                rainContainer.style.opacity = '1';
                snowContainer.style.opacity = '0';
                createRainParticles();
            } else if (weatherCode >= 71 && weatherCode <= 77 || weatherCode >= 85 && weatherCode <= 86) {
                // Snow
                rainContainer.style.opacity = '0';
                snowContainer.style.opacity = '1';
                createSnowParticles();
            } else {
                // Clear weather
                rainContainer.style.opacity = '0';
                snowContainer.style.opacity = '0';
            }
        }

        // Create rain particles
        function createRainParticles() {
            const rainContainer = document.getElementById('rainParticles');
            const particleCount = 100;

            for (let i = 0; i < particleCount; i++) {
                const drop = document.createElement('div');
                drop.className = 'rain-drop';
                drop.style.left = `${Math.random() * 100}%`;
                drop.style.animationDelay = `${Math.random() * 1}s`;
                drop.style.animationDuration = `${0.5 + Math.random() * 0.5}s`;
                rainContainer.appendChild(drop);
                rainDrops.push(drop);
            }
        }

        // Create snow particles
        function createSnowParticles() {
            const snowContainer = document.getElementById('snowParticles');
            const particleCount = 80;

            for (let i = 0; i < particleCount; i++) {
                const flake = document.createElement('div');
                flake.className = 'snow-flake';
                flake.style.left = `${Math.random() * 100}%`;
                flake.style.animationDelay = `${Math.random() * 3}s`;
                flake.style.animationDuration = `${2 + Math.random() * 2}s`;
                snowContainer.appendChild(flake);
                snowFlakes.push(flake);
            }
        }

        // Main animation loop
        function startAnimationLoop() {
            function animate() {
                // Update sky animation if weather data is available
                if (weatherData) {
                    updateSkyAnimation();
                }

                animationFrame = requestAnimationFrame(animate);
            }
            animate();
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            if (weatherData) {
                updateSkyAnimation();
            }
        });

        // Initialize the app when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>